import{c as o,j as e,f as t,I as a,ab as r,u as n,af as i}from"./index-DbmskYgF.js";import{r as s,u as d}from"./xlsx-CkhwWcJv.js";
/**
 * @license lucide-vue-next v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c=o("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]),p={__name:"AlertTitle",props:{class:{type:null,required:!1}},setup(o){const s=o;return(o,d)=>(t(),e("h5",{class:r(n(i)("mb-1 font-medium leading-none tracking-tight",s.class))},[a(o.$slots,"default")],2))}};function l(o){const e={"text/csv":[".csv"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"],"application/vnd.ms-excel":[".xls"],"application/json":[".json"],"text/plain":[".txt"]},t="."+o.name.split(".").pop().toLowerCase();if(!e[o.type])throw new Error(`Tipo de arquivo não permitido: ${o.type}. Apenas CSV, Excel (XLSX/XLS), JSON e TXT são aceitos.`);const a=e[o.type];if(!a.includes(t))throw new Error(`Extensão ${t} não corresponde ao tipo declarado ${o.type}. Extensões permitidas para este tipo: ${a.join(", ")}`);return!0}function u(o){const e=o.split("\n").filter(o=>o.trim());if(e.length<2)throw new Error("Arquivo CSV vazio ou inválido");const t=m(e[0]),a=[];for(let r=1;r<e.length;r++){const o=m(e[r]);if(0===o.length)continue;const n={};t.forEach((e,t)=>{n[e]=o[t]||""}),a.push(n)}return b(a)}function m(o){const e=[];let t="",a=!1;for(let r=0;r<o.length;r++){const n=o[r];'"'===n?a&&'"'===o[r+1]?(t+='"',r++):a=!a:","!==n||a?t+=n:(e.push(t.trim()),t="")}return e.push(t.trim()),e}function f(o){const e=s(o,{type:"array"}),t=e.Sheets[e.SheetNames[0]],a=d.sheet_to_json(t);if(0===a.length)throw new Error("Planilha vazia ou inválida");return b(a)}function h(o){if(!o||"object"!=typeof o)return o;const e=["__proto__","constructor","prototype","__defineGetter__","__defineSetter__","__lookupGetter__","__lookupSetter__"],t=Array.isArray(o)?[]:{};for(const a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e.some(o=>a.toLowerCase()===o.toLowerCase())||(o[a]&&"object"==typeof o[a]?t[a]=h(o[a]):t[a]=o[a]));return t}function v(o,e=0){if(e>5)return e;if(!o||"object"!=typeof o)return e;const t=Object.values(o).filter(o=>o&&"object"==typeof o).map(o=>v(o,e+1));return t.length>0?Math.max(...t):e}function y(o){try{const e=JSON.parse(o);if(!Array.isArray(e))throw new Error("JSON deve ser um array de objetos");if(v(e)>5)throw new Error("JSON muito complexo (profundidade máxima: 5 níveis)");return b(e.map(o=>h(o)))}catch(e){throw new Error("JSON inválido: "+e.message)}}function b(o){return o.map(o=>{const e={};Object.keys(o).forEach(t=>{const a=t.toLowerCase().trim();"id"!==a&&(e[a]=o[t])});const t={unidade:_(e,["unidade"]),metadadoDeProcesso:j(_(e,["metadado de processo","metadadodeprocesso"])),classeProcessual:_(e,["classe processual","classeprocessual","classe"])||"Não informado",tipoDocumento:g(_(e,["tipo de documento","tipodocumento","tipo documento"])),nomeMetadado:_(e,["nome do metadado","nome","metadado","nomemetadado"]),objetivoMetadado:_(e,["objetivo","objetivo do metadado","objetivometadado"]),formatoMetadado:_(e,["formato","formato do metadado","formatometadado"]),admiteMultiplos:j(_(e,["admite múltiplos","admite multiplos","admitemultiplos"])),tipoMetadados:_(e,["tipo de metadados","tipo metadados","tipometadados"]),versaoInicialAtende:_(e,["versão inicial atende","versao inicial atende","versaoinicialatende"]),observacao:_(e,["observação","observacao","obs"])};return Object.keys(t).forEach(o=>{"classeProcessual"!==o&&(""!==t[o]&&null!==t[o]&&void 0!==t[o]||delete t[o])}),delete t.id,t})}function _(o,e){for(const t of e)if(void 0!==o[t]&&null!==o[t])return o[t].toString().trim();return""}function j(o){if("boolean"==typeof o)return o;if("string"==typeof o){const e=o.toLowerCase().trim();return"sim"===e||"yes"===e||"true"===e||"1"===e}return!1}function g(o){if(!o)return[];if(Array.isArray(o))return o.map(o=>null==o?"":String(o).trim()).filter(o=>o.length>0);const e=o.toString();let t=";";return e.includes(";")?t=";":e.includes(",")&&(t=","),e.split(t).map(o=>o.trim()).filter(o=>o.length>0)}function w(o){const e=[],t=[];return o.forEach((o,a)=>{const r=a+2;o.unidade||e.push(`Linha ${r}: Campo "Unidade" é obrigatório`),o.nomeMetadado||e.push(`Linha ${r}: Campo "Nome do Metadado" é obrigatório`),o.tipoMetadados||e.push(`Linha ${r}: Campo "Tipo de Metadados" é obrigatório`),o.tipoDocumento&&0!==o.tipoDocumento.length||e.push(`Linha ${r}: Campo "Tipo de Documento" é obrigatório`),o.objetivoMetadado||t.push(`Linha ${r}: Campo "Objetivo" não preenchido`)}),{errors:e,warnings:t}}export{c as U,p as _,w as a,f as b,y as c,u as p,l as v};
