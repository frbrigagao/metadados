import{c as e,U as a,d as t,E as o,B as s,R as r,b as l,e as d,f as i,g as n,I as u,J as c,u as p,Q as m,M as f,P as v,H as g,k as h,r as y,ao as x,L as b,a0 as _,ai as w,$ as k,ag as q,W as M,al as j,l as S,a5 as D,aq as C,j as A,m as E,z as I,ac as R,y as B,a6 as V,F as $,ad as P,p as T,A as N,D as O}from"./index-D6BWiUEP.js";import{R as U,e as L,d as H,U as F,v as z,f as J,p as G,g as W,h as K,u as X,w as Y,a as Z,b as Q,c as ee,_ as ae}from"./importHelpers-JhwJA0ap.js";import{_ as te,a as oe,b as se,c as re}from"./CardTitle-AhEIrJEE.js";import{_ as le,a as de}from"./index-DXp5PjAL.js";import{_ as ie,a as ne,b as ue,c as ce,d as pe}from"./DialogTitle-CP2wy2KZ.js";import{_ as me}from"./DialogDescription-BhV91owA.js";import{_ as fe}from"./Label-Dgj3Wn80.js";import{c as ve,b as ge,i as he,C as ye}from"./Collection-Bjv2vZPV.js";import{V as xe}from"./VisuallyHiddenInput-BaHgwHFC.js";import{T as be,_ as _e}from"./Progress-CIvt2Xtq.js";import{_ as we}from"./Separator-DAmpjfqE.js";import{I as ke}from"./info-Dm4phGZV.js";import{_ as qe,a as Me,b as je,c as Se,d as De}from"./TableRow-C8B5uA4n.js";import{_ as Ce,a as Ae}from"./TableHeader-DUNd_lk1.js";import"./utils-CYxClmdu.js";import"./nullish-aV-w2MPu.js";
/**
 * @license lucide-vue-next v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=e("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]),Ie=e("file-input",[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4",key:"1pf5j1"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M2 15h10",key:"jfw4w8"}],["path",{d:"m9 18 3-3-3-3",key:"112psh"}]]),Re=e("file-json",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]]),Be=e("file-output",[["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M4 7V4a2 2 0 0 1 2-2 2 2 0 0 0-2 2",key:"1vk7w2"}],["path",{d:"M4.063 20.999a2 2 0 0 0 2 1L18 22a2 2 0 0 0 2-2V7l-5-5H6",key:"1jink5"}],["path",{d:"m5 11-3 3",key:"1dgrs4"}],["path",{d:"m5 17-3-3h10",key:"1mvvaf"}]]),Ve=e("file-spreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);
/**
 * @license lucide-vue-next v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var $e=t({__name:"Radio",props:{id:{type:String,required:!1},value:{type:null,required:!1},disabled:{type:Boolean,required:!1,default:!1},checked:{type:Boolean,required:!1,default:void 0},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"button"},name:{type:String,required:!1},required:{type:Boolean,required:!1}},emits:["update:checked","select"],setup(e,{emit:t}){const g=e,h=t,y=o(g,"checked",h,{passive:void 0===g.checked}),{value:x}=s(g),{forwardRef:b,currentElement:_}=r(),w=ve(_),k=l(()=>g.id&&_.value?document.querySelector(`[for="${g.id}"]`)?.innerText??g.value:void 0);function q(e){g.disabled||function(e,t,o){a("radio.select",o,{originalEvent:e,value:t})}(e,g.value,e=>{h("select",e),e?.defaultPrevented||(y.value=!0,w.value&&e.stopPropagation())})}return(e,a)=>(i(),d(p(v),m(e.$attrs,{id:e.id,ref:p(b),role:"radio",type:"button"===e.as?"button":void 0,as:e.as,"aria-checked":p(y),"aria-label":k.value,"as-child":e.asChild,disabled:e.disabled?"":void 0,"data-state":p(y)?"checked":"unchecked","data-disabled":e.disabled?"":void 0,value:p(x),required:e.required,name:e.name,onClick:f(q,["stop"])}),{default:n(()=>[u(e.$slots,"default",{checked:p(y)}),p(w)&&e.name?(i(),d(p(xe),{key:0,type:"radio",tabindex:"-1",value:p(x),checked:!!p(y),name:e.name,disabled:e.disabled,required:e.required},null,8,["value","checked","name","disabled","required"])):c("v-if",!0)]),_:3},16,["id","type","as","aria-checked","aria-label","as-child","disabled","data-state","data-disabled","value","required","name"]))}});const[Pe,Te]=g("RadioGroupRoot");var Ne=t({__name:"RadioGroupRoot",props:{modelValue:{type:null,required:!1},defaultValue:{type:null,required:!1},disabled:{type:Boolean,required:!1,default:!1},orientation:{type:String,required:!1,default:void 0},dir:{type:String,required:!1},loop:{type:Boolean,required:!1,default:!0},asChild:{type:Boolean,required:!1},as:{type:null,required:!1},name:{type:String,required:!1},required:{type:Boolean,required:!1,default:!1}},emits:["update:modelValue"],setup(e,{emit:a}){const t=e,l=a,{forwardRef:m,currentElement:f}=r(),g=o(t,"modelValue",l,{defaultValue:t.defaultValue,passive:void 0===t.modelValue}),{disabled:y,loop:x,orientation:b,name:_,required:w,dir:k}=s(t),q=ge(k),M=ve(f);return Te({modelValue:g,changeModelValue:e=>{g.value=e},disabled:y,loop:x,orientation:b,name:_?.value,required:w}),(e,a)=>(i(),d(p(U),{"as-child":"",orientation:p(b),dir:p(q),loop:p(x)},{default:n(()=>[h(p(v),{ref:p(m),role:"radiogroup","data-disabled":p(y)?"":void 0,"as-child":e.asChild,as:e.as,"aria-orientation":p(b),"aria-required":p(w),dir:p(q)},{default:n(()=>[u(e.$slots,"default",{modelValue:p(g)}),p(M)&&p(_)?(i(),d(p(xe),{key:0,required:p(w),disabled:p(y),value:p(g),name:p(_)},null,8,["required","disabled","value","name"])):c("v-if",!0)]),_:3},8,["data-disabled","as-child","as","aria-orientation","aria-required","dir"])]),_:3},8,["orientation","dir","loop"]))}});const[Oe,Ue]=g("RadioGroupItem");var Le=t({inheritAttrs:!1,__name:"RadioGroupItem",props:{id:{type:String,required:!1},value:{type:null,required:!1},disabled:{type:Boolean,required:!1,default:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"button"},name:{type:String,required:!1},required:{type:Boolean,required:!1}},emits:["select"],setup(e,{emit:a}){const t=e,o=a,{forwardRef:s,currentElement:c}=r(),v=Pe(),g=l(()=>v.disabled.value||t.disabled),_=l(()=>v.required.value||t.required),w=l(()=>he(v.modelValue?.value,t.value));Ue({disabled:g,checked:w});const k=y(!1),q=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"];function M(){setTimeout(()=>{k.value&&c.value?.click()},0)}return x("keydown",e=>{q.includes(e.key)&&(k.value=!0)}),x("keyup",()=>{k.value=!1}),(e,a)=>(i(),d(p(L),{checked:w.value,disabled:g.value,"as-child":"",focusable:!g.value,active:w.value},{default:n(()=>[h($e,m({...e.$attrs,...t},{ref:p(s),checked:w.value,required:_.value,disabled:g.value,"onUpdate:checked":a[0]||(a[0]=a=>p(v).changeModelValue(e.value)),onSelect:a[1]||(a[1]=e=>o("select",e)),onKeydown:a[2]||(a[2]=b(f(()=>{},["prevent"]),["enter"])),onFocus:M}),{default:n(()=>[u(e.$slots,"default",{checked:w.value,required:_.value,disabled:g.value})]),_:3},16,["checked","required","disabled"])]),_:3},8,["checked","disabled","focusable","active"]))}}),He=t({__name:"RadioGroupIndicator",props:{forceMount:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"span"}},setup(e){const{forwardRef:a}=r(),t=Oe();return(e,o)=>(i(),d(p(_),{present:e.forceMount||p(t).checked.value},{default:n(()=>[h(p(v),m({ref:p(a),"data-state":p(t).checked.value?"checked":"unchecked","data-disabled":p(t).disabled.value?"":void 0,"as-child":e.asChild,as:e.as},e.$attrs),{default:n(()=>[u(e.$slots,"default")]),_:3},16,["data-state","data-disabled","as-child","as"])]),_:3},8,["present"]))}});const Fe={__name:"RadioGroup",props:{modelValue:{type:null,required:!1},defaultValue:{type:null,required:!1},disabled:{type:Boolean,required:!1},orientation:{type:String,required:!1},dir:{type:String,required:!1},loop:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1},name:{type:String,required:!1},required:{type:Boolean,required:!1},class:{type:null,required:!1}},emits:["update:modelValue"],setup(e,{emit:a}){const t=e,o=a,s=w(t,"class"),r=k(s,o);return(e,a)=>(i(),d(p(Ne),m({class:p(q)("grid gap-2",t.class)},p(r)),{default:n(()=>[u(e.$slots,"default")]),_:3},16,["class"]))}},ze={__name:"RadioGroupItem",props:{id:{type:String,required:!1},value:{type:null,required:!1},disabled:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1},name:{type:String,required:!1},required:{type:Boolean,required:!1},class:{type:null,required:!1}},setup(e){const a=e,t=w(a,"class"),o=M(t);return(e,t)=>(i(),d(p(Le),m(p(o),{class:p(q)("peer aspect-square h-4 w-4 rounded-full border border-primary text-primary shadow focus:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",a.class)}),{default:n(()=>[h(p(He),{class:"flex items-center justify-center"},{default:n(()=>[h(p(ye),{class:"h-3.5 w-3.5 text-primary"})]),_:1})]),_:1},16,["class"]))}};function Je(e){if(!e)return"Data desconhecida";const a=new Date(e);return`${String(a.getDate()).padStart(2,"0")}/${String(a.getMonth()+1).padStart(2,"0")}/${a.getFullYear()} às ${String(a.getHours()).padStart(2,"0")}:${String(a.getMinutes()).padStart(2,"0")}`}const Ge={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},We={class:"flex items-center gap-2 text-sm text-muted-foreground"},Ke={key:0,class:"space-y-4 py-4"},Xe={class:"rounded-lg border p-4 space-y-2"},Ye={class:"grid grid-cols-2 gap-2 text-sm"},Ze={class:"font-semibold"},Qe={class:"text-sm space-y-1"},ea={class:"flex justify-between"},aa={class:"font-medium"},ta={class:"flex justify-between"},oa={class:"font-medium"},sa={class:"flex justify-between"},ra={class:"font-medium"},la={class:"flex justify-between"},da={class:"font-medium"},ia={class:"flex justify-between"},na={class:"font-medium"},ua={class:"flex justify-between"},ca={class:"font-medium"},pa={class:"space-y-3"},ma={class:"flex-1"},fa={class:"flex-1"},va={class:"space-y-4 py-4"},ga={class:"text-center text-sm text-muted-foreground"},ha={__name:"BackupCard",setup(e){const{exportAll:a,importAll:t,clearAll:o}=j(),s=S(),r=D(),l=C(),u=y(null),m=y(!1),f=y(!1),v=y(!1),g=y("merge"),x=y(null),b=y(null),_=y({current:0,total:0});async function w(){try{P.info("Preparando backup...");const e=await a(),t={version:"1.0",exportDate:(new Date).toISOString(),appVersion:"4.0",totalRecords:{metadados:e.metadados.length,config:e.config.length,classesProcessuais:e.classesProcessuais.length,tiposDocumentosImportados:e.tiposDocumentosImportados.length,history:e.history.length,tags:e.tags.length},data:e},o=JSON.stringify(t,null,2),s=new Blob([o],{type:"application/json"}),r=function(e){if(0===e)return"0 Bytes";const a=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,a)*100)/100+" "+["Bytes","KB","MB","GB"][a]}(s.size),l=URL.createObjectURL(s),d=document.createElement("a");d.href=l,d.download=function(){const e=new Date;return`backup-metadados-${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}-${String(e.getHours()).padStart(2,"0")}${String(e.getMinutes()).padStart(2,"0")}${String(e.getSeconds()).padStart(2,"0")}.json`}(),d.click(),URL.revokeObjectURL(l);const i=Object.values(t.totalRecords).reduce((e,a)=>e+a,0);P.success(`Backup exportado com sucesso! ${i} registros (${r})`)}catch(e){P.error("Erro ao exportar backup: "+e.message)}}function k(){u.value?.click()}async function q(e){const a=e.target.files?.[0];if(a)try{v.value=!0;try{z(a)}catch(t){return P.error(t.message),v.value=!1,void(u.value&&(u.value.value=""))}P.info("Lendo arquivo de backup...");const e=await a.text(),o=JSON.parse(e),s=function(e){try{return e&&"object"==typeof e?e.version?e.data&&"object"==typeof e.data?["metadados","config","history","tags"].some(a=>e.data[a]&&Array.isArray(e.data[a]))?{valid:!0}:{valid:!1,error:"Nenhuma tabela válida encontrada no backup"}:{valid:!1,error:"Dados do backup não encontrados"}:{valid:!1,error:"Versão do backup não encontrada"}:{valid:!1,error:"Arquivo inválido"}}catch(t){return{valid:!1,error:"Erro ao validar backup: "+t.message}}}(o);if(!s.valid)return void P.error(s.error);x.value=function(e){if(!e||!e.data)return null;const a={version:e.version||"Desconhecida",exportDate:e.exportDate?new Date(e.exportDate):null,appVersion:e.appVersion||"Desconhecida",totalRecords:{metadados:e.data.metadados?.length||0,config:e.data.config?.length||0,classesProcessuais:e.data.classesProcessuais?.length||0,tiposDocumentosImportados:e.data.tiposDocumentosImportados?.length||0,history:e.data.history?.length||0,tags:e.data.tags?.length||0}};return a.total=Object.values(a.totalRecords).reduce((e,a)=>e+a,0),a}(o),b.value=o,g.value="merge",m.value=!0,u.value&&(u.value.value="")}catch(t){P.error("Erro ao ler arquivo: "+t.message)}finally{v.value=!1}}function M(){m.value=!1,x.value=null,b.value=null,g.value="merge"}async function T(){if(b.value)try{v.value=!0,m.value=!1,f.value=!0;const e=x.value.total;_.value={current:0,total:e},"replace"===g.value&&(P.info("Criando backup de segurança..."),await w(),P.info("Limpando banco de dados..."),await o()),P.info("Importando dados...");const a=b.value.data,d=["metadados","config","classesProcessuais","tiposDocumentosImportados","history","tags"];let i=0;for(const t of d)a[t]&&a[t].length>0&&(_.value.current=i,await new Promise(e=>setTimeout(e,200))),i+=a[t]?.length||0;await t(a),_.value.current=e,P.info("Atualizando interface..."),await Promise.all([r.loadConfig(),r.loadClassesProcessuais(),r.loadTiposDocumentosImportados(),s.loadMetadados(),l.loadHistory()]),f.value=!1;const n="replace"===g.value?"substituídos":"mesclados";P.success(`Backup importado com sucesso! ${e} registros ${n}`),x.value=null,b.value=null,g.value="merge"}catch(e){f.value=!1,P.error("Erro ao importar backup: "+e.message)}finally{v.value=!1}}return(e,a)=>(i(),A($,null,[h(p(oe),null,{default:n(()=>[h(p(te),{class:"space-y-6 pt-6"},{default:n(()=>[h(p(le),null,{default:n(()=>[h(p(ke),{class:"w-4 h-4"}),h(p(H),null,{default:n(()=>[...a[5]||(a[5]=[I("O backup completo inclui",-1)])]),_:1}),h(p(de),null,{default:n(()=>[...a[6]||(a[6]=[E("ul",{class:"list-disc pl-4 space-y-1 mt-2"},[E("li",null,"Todos os metadados cadastrados"),E("li",null,"Configurações (unidades, tipos de documento, formatos)"),E("li",null,"Classes processuais (se carregadas)"),E("li",null,"Tipos de documentos importados (se importados)"),E("li",null,"Histórico completo de alterações")],-1)])]),_:1})]),_:1}),E("div",Ge,[h(p(oe),{class:"cursor-pointer transition-all hover:bg-accent",onClick:w},{default:n(()=>[h(p(te),{class:"flex flex-col items-center justify-center py-8 space-y-3"},{default:n(()=>[h(p(Ee),{class:"w-12 h-12 text-muted-foreground"}),a[7]||(a[7]=E("div",{class:"text-lg font-semibold"},"Exportar Backup",-1)),a[8]||(a[8]=E("div",{class:"text-sm text-muted-foreground text-center"}," Salvar cópia completa do banco de dados ",-1))]),_:1})]),_:1}),h(p(oe),{class:"cursor-pointer transition-all hover:bg-accent",onClick:k},{default:n(()=>[h(p(te),{class:"flex flex-col items-center justify-center py-8 space-y-3"},{default:n(()=>[h(p(F),{class:"w-12 h-12 text-muted-foreground"}),a[9]||(a[9]=E("div",{class:"text-lg font-semibold"},"Importar Backup",-1)),a[10]||(a[10]=E("div",{class:"text-sm text-muted-foreground text-center"}," Restaurar dados de um backup anterior ",-1))]),_:1})]),_:1})]),E("input",{ref_key:"fileInputRef",ref:u,type:"file",accept:".json",class:"hidden",onChange:q},null,544),h(p(we)),E("div",We,[h(p(R),{class:"w-4 h-4"}),a[11]||(a[11]=I(" Formato: JSON com todas as tabelas do banco de dados ",-1))])]),_:1})]),_:1}),h(p(pe),{open:m.value,"onUpdate:open":a[3]||(a[3]=e=>m.value=e)},{default:n(()=>[h(p(ie),{class:"max-w-2xl"},{default:n(()=>[h(p(ne),null,{default:n(()=>[h(p(ue),null,{default:n(()=>[...a[12]||(a[12]=[I("Importar Backup Completo",-1)])]),_:1}),h(p(me),null,{default:n(()=>[...a[13]||(a[13]=[I(" Escolha como deseja importar os dados do backup ",-1)])]),_:1})]),_:1}),x.value?(i(),A("div",Ke,[E("div",Xe,[a[23]||(a[23]=E("div",{class:"font-semibold"},"Informações do Backup",-1)),E("div",Ye,[a[14]||(a[14]=E("div",{class:"text-muted-foreground"},"Data do backup:",-1)),E("div",null,B(p(Je)(x.value.exportDate)),1),a[15]||(a[15]=E("div",{class:"text-muted-foreground"},"Versão:",-1)),E("div",null,B(x.value.version),1),a[16]||(a[16]=E("div",{class:"text-muted-foreground"},"Total de registros:",-1)),E("div",Ze,B(x.value.total),1)]),h(p(we),{class:"my-3"}),E("div",Qe,[E("div",ea,[a[17]||(a[17]=E("span",{class:"text-muted-foreground"},"Metadados:",-1)),E("span",aa,B(x.value.totalRecords.metadados),1)]),E("div",ta,[a[18]||(a[18]=E("span",{class:"text-muted-foreground"},"Configurações:",-1)),E("span",oa,B(x.value.totalRecords.config),1)]),E("div",sa,[a[19]||(a[19]=E("span",{class:"text-muted-foreground"},"Classes Processuais:",-1)),E("span",ra,B(x.value.totalRecords.classesProcessuais),1)]),E("div",la,[a[20]||(a[20]=E("span",{class:"text-muted-foreground"},"Tipos de Documentos Importados:",-1)),E("span",da,B(x.value.totalRecords.tiposDocumentosImportados),1)]),E("div",ia,[a[21]||(a[21]=E("span",{class:"text-muted-foreground"},"Histórico:",-1)),E("span",na,B(x.value.totalRecords.history),1)]),E("div",ua,[a[22]||(a[22]=E("span",{class:"text-muted-foreground"},"Tags:",-1)),E("span",ca,B(x.value.totalRecords.tags),1)])])]),E("div",pa,[h(p(fe),null,{default:n(()=>[...a[24]||(a[24]=[I("Modo de Importação",-1)])]),_:1}),h(p(Fe),{modelValue:g.value,"onUpdate:modelValue":a[2]||(a[2]=e=>g.value=e)},{default:n(()=>[E("div",{class:"flex items-start space-x-3 rounded-lg border p-4 cursor-pointer hover:bg-accent",onClick:a[0]||(a[0]=e=>g.value="merge")},[h(p(ze),{value:"merge",id:"merge"}),E("div",ma,[h(p(fe),{for:"merge",class:"cursor-pointer font-semibold"},{default:n(()=>[...a[25]||(a[25]=[I(" Mesclar Dados ",-1)])]),_:1}),a[26]||(a[26]=E("p",{class:"text-sm text-muted-foreground mt-1"}," Adiciona novos registros e atualiza os existentes. Nenhum dado será removido. ",-1))])]),E("div",{class:"flex items-start space-x-3 rounded-lg border p-4 cursor-pointer hover:bg-accent",onClick:a[1]||(a[1]=e=>g.value="replace")},[h(p(ze),{value:"replace",id:"replace"}),E("div",fa,[h(p(fe),{for:"replace",class:"cursor-pointer font-semibold text-destructive"},{default:n(()=>[...a[27]||(a[27]=[I(" Substituir Tudo ",-1)])]),_:1}),a[28]||(a[28]=E("p",{class:"text-sm text-muted-foreground mt-1"}," Remove todos os dados atuais e substitui pelos dados do backup. Esta ação é irreversível! ",-1))])])]),_:1},8,["modelValue"])]),"replace"===g.value?(i(),d(p(le),{key:0,variant:"destructive"},{default:n(()=>[h(p(R),{class:"w-4 h-4"}),h(p(H),null,{default:n(()=>[...a[29]||(a[29]=[I("ATENÇÃO: Ação Irreversível!",-1)])]),_:1}),h(p(de),null,{default:n(()=>[...a[30]||(a[30]=[I(" Todos os dados atuais serão permanentemente apagados, incluindo metadados, configurações e histórico. Recomendamos fazer um backup antes de prosseguir. ",-1)])]),_:1})]),_:1})):c("",!0)])):c("",!0),h(p(ce),null,{default:n(()=>[h(p(V),{variant:"outline",onClick:M},{default:n(()=>[...a[31]||(a[31]=[I(" Cancelar ",-1)])]),_:1}),"merge"===g.value?(i(),d(p(V),{key:0,onClick:T,disabled:v.value},{default:n(()=>[h(p(F),{class:"w-4 h-4 mr-2"}),a[32]||(a[32]=I(" Confirmar Mesclagem ",-1))]),_:1},8,["disabled"])):(i(),d(p(V),{key:1,variant:"destructive",onClick:T,disabled:v.value},{default:n(()=>[h(p(be),{class:"w-4 h-4 mr-2"}),a[33]||(a[33]=I(" Sim, Substituir Tudo ",-1))]),_:1},8,["disabled"]))]),_:1})]),_:1})]),_:1},8,["open"]),h(p(pe),{open:f.value,"onUpdate:open":a[4]||(a[4]=e=>f.value=e),closable:!1},{default:n(()=>[h(p(ie),{class:"max-w-md"},{default:n(()=>[h(p(ne),null,{default:n(()=>[h(p(ue),null,{default:n(()=>[...a[34]||(a[34]=[I("Importando Backup",-1)])]),_:1}),h(p(me),null,{default:n(()=>[...a[35]||(a[35]=[I(" Por favor, aguarde enquanto os dados são importados... ",-1)])]),_:1})]),_:1}),E("div",va,[a[36]||(a[36]=E("div",{class:"flex items-center justify-center"},[E("div",{class:"animate-spin rounded-full h-12 w-12 border-4 border-primary border-t-transparent"})],-1)),E("div",ga," Importando "+B(_.value.current)+" de "+B(_.value.total)+" registros... ",1),h(p(_e),{value:_.value.current/_.value.total*100},null,8,["value"])])]),_:1})]),_:1},8,["open"])],64))}},ya={class:"flex items-center gap-2"},xa={key:0},ba={class:"border rounded-md max-h-[300px] overflow-auto"},_a={key:0},wa={key:1},ka={key:0,class:"text-sm text-muted-foreground mt-2"},qa={key:1,class:"space-y-2"},Ma={class:"list-disc pl-4 space-y-1"},ja={key:0,class:"text-xs mt-2"},Sa={class:"list-disc pl-4 space-y-1"},Da={key:0,class:"text-xs mt-2"},Ca={class:"flex items-center gap-2 text-sm text-muted-foreground"},Aa={__name:"ImportCard",setup(e){const a=S(),t=y(null),o=y(null),s=y([]),r=y(null),l=y(!1);async function u(e){const a=e.target.files?.[0];if(a){o.value=a,s.value=[],r.value=null;try{l.value=!0;try{z(a)}catch(t){throw new Error(t.message)}const e=5242880;if(a.size>e)throw new Error(`Arquivo muito grande (max ${e/1024/1024}MB). Arquivo atual: ${(a.size/1024/1024).toFixed(2)}MB`);const o=a.name.split(".").pop().toLowerCase(),d=1e4;if("csv"===o){const e=(await m(a)).split("\n").filter(e=>e.trim());if(e.length>d+1)throw new Error(`Arquivo CSV muito grande (max ${d} registros). Arquivo contém aproximadamente: ${e.length-1} linhas`)}else if("json"===o){const e=(await m(a)).match(/\{[^}]*\}/g);if(e&&e.length>d)throw new Error(`Arquivo JSON muito grande (max ${d} registros). Arquivo contém aproximadamente: ${e.length} objetos`)}const i=await async function(e){const a=e.name.split(".").pop().toLowerCase();return new Promise((t,o)=>{const s=new FileReader;s.onload=async e=>{try{let s;if("csv"===a)s=G(e.target.result);else if("xlsx"===a||"xls"===a)s=W(e.target.result);else{if("json"!==a)return void o(new Error("Formato de arquivo não suportado"));s=K(e.target.result)}t(s)}catch(s){o(s)}},s.onerror=()=>o(new Error("Erro ao ler arquivo")),"xlsx"===a||"xls"===a?s.readAsArrayBuffer(e):s.readAsText(e)})}(a),n=1e4;if(i.length>n)throw new Error(`Muitos registros (max ${n}). Arquivo contém: ${i.length}`);s.value=i,r.value=J(i)}catch(d){P.error("Erro ao ler arquivo: "+d.message)}finally{l.value=!1}}}async function m(e){return new Promise((a,t)=>{const o=new FileReader;o.onload=e=>a(e.target.result),o.onerror=()=>t(new Error("Erro ao ler arquivo")),o.readAsText(e)})}async function f(){if(s.value.length)if(r.value?.errors.length>0)P.error("Corrija os erros antes de importar");else try{l.value=!0;for(const e of s.value)await a.addMetadado(e);P.success(`${s.value.length} registros importados com sucesso!`),t.value&&(t.value.value=""),o.value=null,s.value=[],r.value=null}catch(e){P.error("Erro ao importar: "+e.message)}finally{l.value=!1}else P.error("Nenhum dado para importar")}return(e,a)=>(i(),d(p(oe),null,{default:n(()=>[h(p(se),null,{default:n(()=>[h(p(re),{class:"flex items-center gap-2"},{default:n(()=>[h(p(Ie),{class:"w-5 h-5"}),a[0]||(a[0]=I(" Importar Dados ",-1))]),_:1})]),_:1}),h(p(te),{class:"space-y-4"},{default:n(()=>[h(p(le),{variant:"warning"},{default:n(()=>[h(p(R),{class:"w-4 h-4"}),h(p(H),null,{default:n(()=>[...a[1]||(a[1]=[I("Atenção",-1)])]),_:1}),h(p(de),null,{default:n(()=>[...a[2]||(a[2]=[I(" A importação irá adicionar os novos registros aos existentes. Para substituir todos os dados, limpe o banco antes. ",-1)])]),_:1})]),_:1}),E("div",ya,[h(p(qe),{ref_key:"fileInputRef",ref:t,type:"file",accept:".csv,.xlsx,.xls,.json",disabled:l.value,onChange:u,class:"flex-1"},null,8,["disabled"]),h(p(V),{disabled:!o.value||l.value,onClick:f},{default:n(()=>[h(p(F),{class:"w-4 h-4 mr-2"}),a[3]||(a[3]=I(" Importar ",-1))]),_:1},8,["disabled"])]),s.value.length>0?(i(),A("div",xa,[h(p(oe),null,{default:n(()=>[h(p(se),null,{default:n(()=>[h(p(re),{class:"text-lg"},{default:n(()=>[I(" Pré-visualização ("+B(s.value.length)+" registros) ",1)]),_:1})]),_:1}),h(p(te),null,{default:n(()=>[E("div",ba,[h(p(Me),null,{default:n(()=>[h(p(Ce),null,{default:n(()=>[h(p(je),null,{default:n(()=>[h(p(Ae),null,{default:n(()=>[...a[4]||(a[4]=[I("Unidade",-1)])]),_:1}),h(p(Ae),null,{default:n(()=>[...a[5]||(a[5]=[I("Tipo Documento",-1)])]),_:1}),h(p(Ae),null,{default:n(()=>[...a[6]||(a[6]=[I("Nome Metadado",-1)])]),_:1}),h(p(Ae),null,{default:n(()=>[...a[7]||(a[7]=[I("Tipo",-1)])]),_:1})]),_:1})]),_:1}),h(p(Se),null,{default:n(()=>[(i(!0),A($,null,T(s.value.slice(0,10),(e,a)=>(i(),d(p(je),{key:a},{default:n(()=>[h(p(De),null,{default:n(()=>[I(B(e.unidade),1)]),_:2},1024),h(p(De),null,{default:n(()=>[Array.isArray(e.tipoDocumento)?(i(),A("span",_a,B(e.tipoDocumento.join(", ")),1)):(i(),A("span",wa,B(e.tipoDocumento),1))]),_:2},1024),h(p(De),null,{default:n(()=>[I(B(e.nomeMetadado),1)]),_:2},1024),h(p(De),null,{default:n(()=>[I(B(e.tipoMetadados),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),s.value.length>10?(i(),A("p",ka," Mostrando 10 de "+B(s.value.length)+" registros ",1)):c("",!0)]),_:1})]),_:1})])):c("",!0),r.value?(i(),A("div",qa,[r.value.errors.length>0?(i(),d(p(le),{key:0,variant:"destructive"},{default:n(()=>[h(p(R),{class:"w-4 h-4"}),h(p(H),null,{default:n(()=>[I(B(r.value.errors.length)+" "+B(1===r.value.errors.length?"erro encontrado":"erros encontrados"),1)]),_:1}),h(p(de),null,{default:n(()=>[E("ul",Ma,[(i(!0),A($,null,T(r.value.errors.slice(0,5),(e,a)=>(i(),A("li",{key:a},B(e),1))),128))]),r.value.errors.length>5?(i(),A("p",ja," ... e mais "+B(r.value.errors.length-5)+" erros ",1)):c("",!0)]),_:1})]),_:1})):c("",!0),r.value.warnings.length>0?(i(),d(p(le),{key:1,variant:"warning"},{default:n(()=>[h(p(R),{class:"w-4 h-4"}),h(p(H),null,{default:n(()=>[I(B(r.value.warnings.length)+" "+B(1===r.value.warnings.length?"aviso":"avisos"),1)]),_:1}),h(p(de),null,{default:n(()=>[E("ul",Sa,[(i(!0),A($,null,T(r.value.warnings.slice(0,3),(e,a)=>(i(),A("li",{key:a},B(e),1))),128))]),r.value.warnings.length>3?(i(),A("p",Da," ... e mais "+B(r.value.warnings.length-3)+" avisos ",1)):c("",!0)]),_:1})]),_:1})):c("",!0)])):c("",!0),h(p(we)),E("div",Ca,[h(p(ke),{class:"w-4 h-4"}),a[8]||(a[8]=I(" Formatos suportados: CSV, Excel (.xlsx, .xls), JSON ",-1))])]),_:1})]),_:1}))}};function Ea(e){let a=e.toString();return["=","+","-","@","\t","\r","\n"].some(e=>a.startsWith(e))&&(a="'"+a),a=a.replace(/"/g,'""'),`"${a}"`}function Ia(e){if(null==e)return"";const a=String(e);return["=","+","-","@","\t","\r","\n"].some(e=>a.startsWith(e))?"'"+a:a}const Ra={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Ba={class:"flex items-center gap-2 text-sm text-muted-foreground"},Va={__name:"ExportCard",setup(e){const a=S();async function t(e){try{const t=a.metadados;if(0===t.length)return void P.error("Não há dados para exportar");switch(e){case"csv":!function(e){const a=e.map(e=>[e.unidade||"",e.metadadoDeProcesso?"Sim":"Não",e.classeProcessual||"Não informado",Array.isArray(e.tipoDocumento)?e.tipoDocumento.join(";"):e.tipoDocumento||"",e.nomeMetadado||"",e.objetivoMetadado||"",e.formatoMetadado||"",e.admiteMultiplos?"Sim":"Não",e.tipoMetadados||"",e.versaoInicialAtende||"",e.observacao||""]);let t=["Unidade","Metadado de Processo","Classe Processual","Tipo de Documento","Nome do Metadado","Objetivo","Formato","Admite Múltiplos","Tipo de Metadados","Versão Inicial Atende","Observação"].map(Ea).join(",")+"\n";a.forEach(e=>{t+=e.map(Ea).join(",")+"\n"});const o=new Blob([t],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a");s.href=URL.createObjectURL(o),s.download=`metadados_${(new Date).toISOString().split("T")[0]}.csv`,s.click()}(t),P.success(`${t.length} registros exportados para CSV`);break;case"excel":!function(e){const a=e.map(e=>({Unidade:Ia(e.unidade),"Metadado de Processo":e.metadadoDeProcesso?"Sim":"Não","Classe Processual":Ia(e.classeProcessual||"Não informado"),"Tipo de Documento":Ia(Array.isArray(e.tipoDocumento)?e.tipoDocumento.join(";"):e.tipoDocumento),"Nome do Metadado":Ia(e.nomeMetadado),Objetivo:Ia(e.objetivoMetadado),Formato:Ia(e.formatoMetadado),"Admite Múltiplos":e.admiteMultiplos?"Sim":"Não","Tipo de Metadados":Ia(e.tipoMetadados),"Versão Inicial Atende":Ia(e.versaoInicialAtende),"Observação":Ia(e.observacao)})),t=X.json_to_sheet(a);t["!cols"]=[{wch:15},{wch:20},{wch:35},{wch:30},{wch:30},{wch:40},{wch:20},{wch:18},{wch:18},{wch:22},{wch:40}];const o=[];e.forEach(e=>{(Array.isArray(e.tipoDocumento)?e.tipoDocumento:e.tipoDocumento?[e.tipoDocumento]:["Não especificado"]).forEach(a=>{o.push({"Tipo de Documento":Ia(a),"Nome do Metadado":Ia(e.nomeMetadado),Unidade:Ia(e.unidade),Objetivo:Ia(e.objetivoMetadado),Formato:Ia(e.formatoMetadado),"Admite Múltiplos":e.admiteMultiplos?"Sim":"Não","Tipo de Metadados":Ia(e.tipoMetadados),"Metadado de Processo":e.metadadoDeProcesso?"Sim":"Não","Versão Inicial Atende":Ia(e.versaoInicialAtende),"Observação":Ia(e.observacao),"Classe Processual":Ia(e.classeProcessual||"Não informado")})})}),o.sort((e,a)=>{const t=e["Tipo de Documento"].localeCompare(a["Tipo de Documento"]);return 0!==t?t:e["Nome do Metadado"].localeCompare(a["Nome do Metadado"])});const s=X.json_to_sheet(o);s["!cols"]=[{wch:35},{wch:30},{wch:15},{wch:40},{wch:20},{wch:18},{wch:18},{wch:20},{wch:22},{wch:40},{wch:35}];const r=X.book_new();X.book_append_sheet(r,t,"Metadados"),X.book_append_sheet(r,s,"Por Tipo de Documento"),Y(r,`metadados_${(new Date).toISOString().split("T")[0]}.xlsx`)}(t),P.success(`${t.length} registros exportados para Excel`);break;case"json":!function(e){const a=JSON.stringify(e,null,2),t=new Blob([a],{type:"application/json"}),o=document.createElement("a");o.href=URL.createObjectURL(t),o.download=`metadados_${(new Date).toISOString().split("T")[0]}.json`,o.click()}(t),P.success(`${t.length} registros exportados para JSON`)}}catch(t){P.error("Erro ao exportar: "+t.message)}}return(e,o)=>(i(),d(p(oe),null,{default:n(()=>[h(p(se),null,{default:n(()=>[h(p(re),{class:"flex items-center gap-2"},{default:n(()=>[h(p(Be),{class:"w-5 h-5"}),o[3]||(o[3]=I(" Exportar Dados ",-1))]),_:1})]),_:1}),h(p(te),{class:"space-y-6"},{default:n(()=>[h(p(le),null,{default:n(()=>[h(p(ke),{class:"w-4 h-4"}),h(p(H),null,{default:n(()=>[...o[4]||(o[4]=[I("Informação",-1)])]),_:1}),h(p(de),null,{default:n(()=>[I(" Exporte todos os "+B(p(a).totalMetadados)+" metadados cadastrados no formato desejado. ",1)]),_:1})]),_:1}),E("div",Ra,[h(p(oe),{class:"cursor-pointer transition-all hover:bg-accent",onClick:o[0]||(o[0]=e=>t("csv"))},{default:n(()=>[h(p(te),{class:"flex flex-col items-center justify-center py-8 space-y-3"},{default:n(()=>[h(p(Ve),{class:"w-12 h-12 text-muted-foreground"}),o[5]||(o[5]=E("div",{class:"text-lg font-semibold"},"CSV",-1)),o[6]||(o[6]=E("div",{class:"text-sm text-muted-foreground text-center"},"Valores Separados por Vírgula",-1))]),_:1})]),_:1}),h(p(oe),{class:"cursor-pointer transition-all hover:bg-accent",onClick:o[1]||(o[1]=e=>t("excel"))},{default:n(()=>[h(p(te),{class:"flex flex-col items-center justify-center py-8 space-y-3"},{default:n(()=>[h(p(Ve),{class:"w-12 h-12 text-muted-foreground"}),o[7]||(o[7]=E("div",{class:"text-lg font-semibold"},"Excel",-1)),o[8]||(o[8]=E("div",{class:"text-sm text-muted-foreground text-center"},"Planilha XLSX",-1))]),_:1})]),_:1}),h(p(oe),{class:"cursor-pointer transition-all hover:bg-accent",onClick:o[2]||(o[2]=e=>t("json"))},{default:n(()=>[h(p(te),{class:"flex flex-col items-center justify-center py-8 space-y-3"},{default:n(()=>[h(p(Re),{class:"w-12 h-12 text-muted-foreground"}),o[9]||(o[9]=E("div",{class:"text-lg font-semibold"},"JSON",-1)),o[10]||(o[10]=E("div",{class:"text-sm text-muted-foreground text-center"},"JavaScript Object Notation",-1))]),_:1})]),_:1})]),h(p(we)),E("div",Ba,[h(p(ke),{class:"w-4 h-4"}),o[11]||(o[11]=I(" O arquivo será baixado automaticamente após a exportação ",-1))])]),_:1})]),_:1}))}},$a={class:"space-y-6"},Pa={class:"flex items-center justify-between"},Ta={__name:"ImportExport",setup:e=>(e,a)=>(i(),A("div",$a,[E("div",Pa,[a[1]||(a[1]=E("h1",{class:"text-3xl font-bold"},"Importar/Exportar",-1)),h(p(N),{variant:"secondary",class:"flex items-center gap-2"},{default:n(()=>[h(p(ke),{class:"w-4 h-4"}),a[0]||(a[0]=I(" Gerencie seus dados em diferentes formatos ",-1))]),_:1})]),h(p(ae),{"default-value":"importar",class:"w-full"},{default:n(()=>[h(p(Z),{class:"grid w-full grid-cols-3"},{default:n(()=>[h(p(Q),{value:"importar",class:"flex items-center gap-2"},{default:n(()=>[h(p(F),{class:"w-4 h-4"}),a[2]||(a[2]=I(" Importar Metadados ",-1))]),_:1}),h(p(Q),{value:"exportar",class:"flex items-center gap-2"},{default:n(()=>[h(p(Ee),{class:"w-4 h-4"}),a[3]||(a[3]=I(" Exportar Metadados ",-1))]),_:1}),h(p(Q),{value:"backup",class:"flex items-center gap-2"},{default:n(()=>[h(p(O),{class:"w-4 h-4"}),a[4]||(a[4]=I(" Backup Completo ",-1))]),_:1})]),_:1}),h(p(ee),{value:"importar",class:"space-y-4 mt-6"},{default:n(()=>[a[5]||(a[5]=E("div",null,[E("h2",{class:"text-xl font-semibold mb-1"},"Importar Metadados"),E("p",{class:"text-sm text-muted-foreground"}," Importe registros de metadados de arquivos CSV, Excel ou JSON ")],-1)),h(Aa)]),_:1}),h(p(ee),{value:"exportar",class:"space-y-4 mt-6"},{default:n(()=>[a[6]||(a[6]=E("div",null,[E("h2",{class:"text-xl font-semibold mb-1"},"Exportar Apenas Metadados"),E("p",{class:"text-sm text-muted-foreground"}," Exporte somente os registros de metadados em diferentes formatos ")],-1)),h(Va)]),_:1}),h(p(ee),{value:"backup",class:"space-y-4 mt-6"},{default:n(()=>[a[7]||(a[7]=E("div",null,[E("h2",{class:"text-xl font-semibold mb-1"},"Backup Completo do Sistema"),E("p",{class:"text-sm text-muted-foreground"}," Exporte e importe todos os dados do sistema incluindo configurações e histórico ")],-1)),h(ha)]),_:1})]),_:1})]))};export{Ta as default};
