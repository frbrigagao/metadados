import{c as e,as as a,m as t,u as o,r as s,j as l,f as r,k as n,g as d,l as i,q as u,E as c,C as m,J as p,A as f,ac as v,F as g,am as h,x,e as y,D as w,G as b}from"./index-DWL0922U.js";import{d as _,v as k,e as j,p as M,f as D,g as S,u as A,w as C,a as I,b as E,c as N,_ as $}from"./importHelpers-Ch3kiamh.js";import{_ as P,a as T,b as O,c as q}from"./CardTitle-gOc8B11I.js";import{_ as B,a as V,U as R}from"./index-Bnw84pr0.js";import{_ as U,a as L,b as F,c as J,d as z}from"./DialogTitle-Ba8nCAUB.js";import{_ as H}from"./DialogDescription-EEdLLk2Z.js";import{T as G,_ as K}from"./Progress-BGrdYmkA.js";import{D as W,_ as X}from"./Separator-CGAyYx5s.js";import{I as Y}from"./info-DX9s__iW.js";import{_ as Z,a as Q,b as ee,c as ae,d as te,e as oe,f as se}from"./TableHeader-LY7ohDVZ.js";import"./Collection-CJd_lVm9.js";import"./utils-DNrdcshq.js";import"./nullish-aV-w2MPu.js";
/**
 * @license lucide-vue-next v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=e("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),re=e("file-input",[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4",key:"1pf5j1"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M2 15h10",key:"jfw4w8"}],["path",{d:"m9 18 3-3-3-3",key:"112psh"}]]),ne=e("file-json",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]]),de=e("file-output",[["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M4 7V4a2 2 0 0 1 2-2 2 2 0 0 0-2 2",key:"1vk7w2"}],["path",{d:"M4.063 20.999a2 2 0 0 0 2 1L18 22a2 2 0 0 0 2-2V7l-5-5H6",key:"1jink5"}],["path",{d:"m5 11-3 3",key:"1dgrs4"}],["path",{d:"m5 17-3-3h10",key:"1mvvaf"}]]),ie=e("file-spreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);
/**
 * @license lucide-vue-next v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */function ue(e){if(!e)return"Data desconhecida";const a=new Date(e);return`${String(a.getDate()).padStart(2,"0")}/${String(a.getMonth()+1).padStart(2,"0")}/${a.getFullYear()} às ${String(a.getHours()).padStart(2,"0")}:${String(a.getMinutes()).padStart(2,"0")}`}const ce={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},me={class:"flex items-center gap-2 text-sm text-muted-foreground"},pe={key:0,class:"space-y-4 py-4"},fe={class:"rounded-lg border p-4 space-y-2"},ve={class:"grid grid-cols-2 gap-2 text-sm"},ge={class:"font-semibold"},he={class:"text-sm space-y-1"},xe={class:"flex justify-between"},ye={class:"font-medium"},we={class:"flex justify-between"},be={class:"font-medium"},_e={class:"flex justify-between"},ke={class:"font-medium"},je={class:"flex justify-between"},Me={class:"font-medium"},De={class:"flex justify-between"},Se={class:"font-medium"},Ae={class:"space-y-4 py-4"},Ce={class:"text-center text-sm text-muted-foreground"},Ie={__name:"BackupCard",setup(e){const{exportAll:x,importAll:y,clearAll:w}=a(),b=t(),j=o(),M=s(null),D=s(!1),S=s(!1),A=s(!1),C=s(null),I=s(null),E=s({current:0,total:0});async function N(){try{h.info("Preparando backup...");const e=await x(),a={version:"1.0",exportDate:(new Date).toISOString(),appVersion:"4.0",totalRecords:{metadados:e.metadados.length,config:e.config.length,classesProcessuais:e.classesProcessuais.length,tiposDocumentosImportados:e.tiposDocumentosImportados.length,tags:e.tags.length},data:e},t=JSON.stringify(a,null,2),o=new Blob([t],{type:"application/json"}),s=function(e){if(0===e)return"0 Bytes";const a=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,a)*100)/100+" "+["Bytes","KB","MB","GB"][a]}(o.size),l=URL.createObjectURL(o),r=document.createElement("a");r.href=l,r.download=function(){const e=new Date;return`backup-metadados-${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}-${String(e.getHours()).padStart(2,"0")}${String(e.getMinutes()).padStart(2,"0")}${String(e.getSeconds()).padStart(2,"0")}.json`}(),r.click(),URL.revokeObjectURL(l);const n=Object.values(a.totalRecords).reduce((e,a)=>e+a,0);h.success(`Backup exportado com sucesso! ${n} registros (${s})`)}catch(e){h.error("Erro ao exportar backup: "+e.message)}}function $(){M.value?.click()}async function O(e){const a=e.target.files?.[0];if(a)try{A.value=!0;try{k(a)}catch(t){return h.error(t.message),A.value=!1,void(M.value&&(M.value.value=""))}h.info("Lendo arquivo de backup...");const e=await a.text(),o=JSON.parse(e),s=function(e){try{return e&&"object"==typeof e?e.version?e.data&&"object"==typeof e.data?["metadados","config","tags"].some(a=>e.data[a]&&Array.isArray(e.data[a]))?{valid:!0}:{valid:!1,error:"Nenhuma tabela válida encontrada no backup"}:{valid:!1,error:"Dados do backup não encontrados"}:{valid:!1,error:"Versão do backup não encontrada"}:{valid:!1,error:"Arquivo inválido"}}catch(t){return{valid:!1,error:"Erro ao validar backup: "+t.message}}}(o);if(!s.valid)return void h.error(s.error);C.value=function(e){if(!e||!e.data)return null;const a={version:e.version||"Desconhecida",exportDate:e.exportDate?new Date(e.exportDate):null,appVersion:e.appVersion||"Desconhecida",totalRecords:{metadados:e.data.metadados?.length||0,config:e.data.config?.length||0,classesProcessuais:e.data.classesProcessuais?.length||0,tiposDocumentosImportados:e.data.tiposDocumentosImportados?.length||0,tags:e.data.tags?.length||0}};return a.total=Object.values(a.totalRecords).reduce((e,a)=>e+a,0),a}(o),I.value=o,D.value=!0,M.value&&(M.value.value="")}catch(t){h.error("Erro ao ler arquivo: "+t.message)}finally{A.value=!1}}function q(){D.value=!1,C.value=null,I.value=null}async function Z(){if(I.value)try{A.value=!0,D.value=!1,S.value=!0;const e=C.value.total;E.value={current:0,total:e},h.info("Criando backup de segurança..."),await N(),h.info("Limpando banco de dados..."),await w(),h.info("Importando dados...");const a=I.value.data,t=["metadados","config","classesProcessuais","tiposDocumentosImportados","tags"];let o=0;for(const s of t)a[s]&&a[s].length>0&&(E.value.current=o,await new Promise(e=>setTimeout(e,200))),o+=a[s]?.length||0;await y(a),E.value.current=e,h.info("Atualizando interface..."),await Promise.all([j.loadConfig(),j.loadClassesProcessuais(),j.loadTiposDocumentosImportados(),b.loadMetadados()]),S.value=!1,h.success(`Backup importado com sucesso! ${e} registros restaurados`),C.value=null,I.value=null}catch(e){S.value=!1,h.error("Erro ao importar backup: "+e.message)}finally{A.value=!1}}return(e,a)=>(r(),l(g,null,[n(i(T),null,{default:d(()=>[n(i(P),{class:"space-y-6 pt-6"},{default:d(()=>[n(i(B),null,{default:d(()=>[n(i(Y),{class:"w-4 h-4"}),n(i(_),null,{default:d(()=>[...a[2]||(a[2]=[c("O backup completo inclui",-1)])]),_:1}),n(i(V),null,{default:d(()=>[...a[3]||(a[3]=[u("ul",{class:"list-disc pl-4 space-y-1 mt-2"},[u("li",null,"Todos os metadados cadastrados"),u("li",null,"Configurações (unidades, tipos de documento, formatos)"),u("li",null,"Classes processuais (se carregadas)"),u("li",null,"Tipos de documentos importados (se importados)")],-1)])]),_:1})]),_:1}),u("div",ce,[n(i(T),{class:"cursor-pointer transition-all hover:bg-accent",onClick:N},{default:d(()=>[n(i(P),{class:"flex flex-col items-center justify-center py-8 space-y-3"},{default:d(()=>[n(i(W),{class:"w-12 h-12 text-muted-foreground"}),a[4]||(a[4]=u("div",{class:"text-lg font-semibold"},"Exportar Backup",-1)),a[5]||(a[5]=u("div",{class:"text-sm text-muted-foreground text-center"}," Salvar cópia completa do banco de dados ",-1))]),_:1})]),_:1}),n(i(T),{class:"cursor-pointer transition-all hover:bg-accent",onClick:$},{default:d(()=>[n(i(P),{class:"flex flex-col items-center justify-center py-8 space-y-3"},{default:d(()=>[n(i(R),{class:"w-12 h-12 text-muted-foreground"}),a[6]||(a[6]=u("div",{class:"text-lg font-semibold"},"Importar Backup",-1)),a[7]||(a[7]=u("div",{class:"text-sm text-muted-foreground text-center"}," Restaurar dados de um backup anterior ",-1))]),_:1})]),_:1})]),u("input",{ref_key:"fileInputRef",ref:M,type:"file",accept:".json",class:"hidden",onChange:O},null,544),n(i(X)),u("div",me,[n(i(m),{class:"w-4 h-4"}),a[8]||(a[8]=c(" Formato: JSON com todas as tabelas do banco de dados ",-1))])]),_:1})]),_:1}),n(i(z),{open:D.value,"onUpdate:open":a[0]||(a[0]=e=>D.value=e)},{default:d(()=>[n(i(U),{class:"max-w-2xl"},{default:d(()=>[n(i(L),null,{default:d(()=>[n(i(F),null,{default:d(()=>[...a[9]||(a[9]=[c("Importar Backup Completo",-1)])]),_:1}),n(i(H),null,{default:d(()=>[...a[10]||(a[10]=[c(" Escolha como deseja importar os dados do backup ",-1)])]),_:1})]),_:1}),C.value?(r(),l("div",pe,[u("div",fe,[a[19]||(a[19]=u("div",{class:"font-semibold"},"Informações do Backup",-1)),u("div",ve,[a[11]||(a[11]=u("div",{class:"text-muted-foreground"},"Data do backup:",-1)),u("div",null,f(i(ue)(C.value.exportDate)),1),a[12]||(a[12]=u("div",{class:"text-muted-foreground"},"Versão:",-1)),u("div",null,f(C.value.version),1),a[13]||(a[13]=u("div",{class:"text-muted-foreground"},"Total de registros:",-1)),u("div",ge,f(C.value.total),1)]),n(i(X),{class:"my-3"}),u("div",he,[u("div",xe,[a[14]||(a[14]=u("span",{class:"text-muted-foreground"},"Metadados:",-1)),u("span",ye,f(C.value.totalRecords.metadados),1)]),u("div",we,[a[15]||(a[15]=u("span",{class:"text-muted-foreground"},"Configurações:",-1)),u("span",be,f(C.value.totalRecords.config),1)]),u("div",_e,[a[16]||(a[16]=u("span",{class:"text-muted-foreground"},"Classes Processuais:",-1)),u("span",ke,f(C.value.totalRecords.classesProcessuais),1)]),u("div",je,[a[17]||(a[17]=u("span",{class:"text-muted-foreground"},"Tipos de Documentos Importados:",-1)),u("span",Me,f(C.value.totalRecords.tiposDocumentosImportados),1)]),u("div",De,[a[18]||(a[18]=u("span",{class:"text-muted-foreground"},"Tags:",-1)),u("span",Se,f(C.value.totalRecords.tags),1)])])]),n(i(B),{variant:"destructive"},{default:d(()=>[n(i(G),{class:"w-4 h-4"}),n(i(_),null,{default:d(()=>[...a[20]||(a[20]=[c("Atenção: Substituição de Dados",-1)])]),_:1}),n(i(V),null,{default:d(()=>[...a[21]||(a[21]=[c(" A importação irá substituir todos os dados atuais pelos dados do backup. Um backup de segurança será criado automaticamente antes da substituição. ",-1)])]),_:1})]),_:1})])):p("",!0),n(i(J),null,{default:d(()=>[n(i(v),{variant:"outline",onClick:q},{default:d(()=>[...a[22]||(a[22]=[c(" Cancelar ",-1)])]),_:1}),n(i(v),{variant:"destructive",onClick:Z,disabled:A.value},{default:d(()=>[n(i(G),{class:"w-4 h-4 mr-2"}),a[23]||(a[23]=c(" Confirmar Importação ",-1))]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"]),n(i(z),{open:S.value,"onUpdate:open":a[1]||(a[1]=e=>S.value=e),closable:!1},{default:d(()=>[n(i(U),{class:"max-w-md"},{default:d(()=>[n(i(L),null,{default:d(()=>[n(i(F),null,{default:d(()=>[...a[24]||(a[24]=[c("Importando Backup",-1)])]),_:1}),n(i(H),null,{default:d(()=>[...a[25]||(a[25]=[c(" Por favor, aguarde enquanto os dados são importados... ",-1)])]),_:1})]),_:1}),u("div",Ae,[a[26]||(a[26]=u("div",{class:"flex items-center justify-center"},[u("div",{class:"animate-spin rounded-full h-12 w-12 border-4 border-primary border-t-transparent"})],-1)),u("div",Ce," Importando "+f(E.value.current)+" de "+f(E.value.total)+" registros... ",1),n(i(K),{value:E.value.current/E.value.total*100},null,8,["value"])])]),_:1})]),_:1},8,["open"])],64))}},Ee={class:"flex items-center gap-2"},Ne={key:0},$e={class:"border rounded-md max-h-[300px] overflow-auto"},Pe={key:0},Te={key:1},Oe={key:0,class:"text-sm text-muted-foreground mt-2"},qe={key:1,class:"space-y-2"},Be={class:"list-disc pl-4 space-y-1"},Ve={key:0,class:"text-xs mt-2"},Re={class:"list-disc pl-4 space-y-1"},Ue={key:0,class:"text-xs mt-2"},Le={class:"flex items-center gap-2 text-sm text-muted-foreground"},Fe={__name:"ImportCard",emits:["switch-tab"],setup(e,{emit:a}){const o=a,b=t(),A=s(null),C=s(null),I=s([]),E=s(null),N=s(!1),$=s(!1);async function G(e){const a=e.target.files?.[0];if(a){C.value=a,I.value=[],E.value=null,$.value=!1;try{N.value=!0;try{k(a)}catch(t){throw new Error(t.message)}const e=5242880;if(a.size>e)throw new Error(`Arquivo muito grande (max ${e/1024/1024}MB). Arquivo atual: ${(a.size/1024/1024).toFixed(2)}MB`);const o=a.name.split(".").pop().toLowerCase(),s=1e4;if("csv"===o){const e=(await W(a)).split("\n").filter(e=>e.trim());if(e.length>s+1)throw new Error(`Arquivo CSV muito grande (max ${s} registros). Arquivo contém aproximadamente: ${e.length-1} linhas`)}else if("json"===o){const e=(await W(a)).match(/\{[^}]*\}/g);if(e&&e.length>s)throw new Error(`Arquivo JSON muito grande (max ${s} registros). Arquivo contém aproximadamente: ${e.length} objetos`)}const l=await async function(e){const a=e.name.split(".").pop().toLowerCase();return new Promise((t,o)=>{const s=new FileReader;s.onload=async e=>{try{let s;if("csv"===a)s=M(e.target.result);else if("xlsx"===a||"xls"===a)s=D(e.target.result);else{if("json"!==a)return void o(new Error("Formato de arquivo não suportado"));s=S(e.target.result)}t(s)}catch(s){o(s)}},s.onerror=()=>o(new Error("Erro ao ler arquivo")),"xlsx"===a||"xls"===a?s.readAsArrayBuffer(e):s.readAsText(e)})}(a),r=1e4;if(l.length>r)throw new Error(`Muitos registros (max ${r}). Arquivo contém: ${l.length}`);I.value=l,E.value=j(l)}catch(o){o.message.includes("BACKUP_DETECTED")?$.value=!0:h.error("Erro ao ler arquivo: "+o.message)}finally{N.value=!1}}}function K(){$.value=!1,o("switch-tab","backup")}async function W(e){return new Promise((a,t)=>{const o=new FileReader;o.onload=e=>a(e.target.result),o.onerror=()=>t(new Error("Erro ao ler arquivo")),o.readAsText(e)})}async function ne(){if(I.value.length)if(E.value?.errors.length>0)h.error("Corrija os erros antes de importar");else try{N.value=!0;for(const e of I.value)await b.addMetadado(e);h.success(`${I.value.length} registros importados com sucesso!`),A.value&&(A.value.value=""),C.value=null,I.value=[],E.value=null}catch(e){h.error("Erro ao importar: "+e.message)}finally{N.value=!1}else h.error("Nenhum dado para importar")}return(e,a)=>(r(),l(g,null,[n(i(T),null,{default:d(()=>[n(i(O),null,{default:d(()=>[n(i(q),{class:"flex items-center gap-2"},{default:d(()=>[n(i(re),{class:"w-5 h-5"}),a[2]||(a[2]=c(" Importar Dados ",-1))]),_:1})]),_:1}),n(i(P),{class:"space-y-4"},{default:d(()=>[n(i(B),{variant:"warning"},{default:d(()=>[n(i(m),{class:"w-4 h-4"}),n(i(_),null,{default:d(()=>[...a[3]||(a[3]=[c("Atenção",-1)])]),_:1}),n(i(V),null,{default:d(()=>[...a[4]||(a[4]=[c(" A importação irá adicionar os novos registros aos existentes. Para substituir todos os dados, limpe o banco antes. ",-1)])]),_:1})]),_:1}),u("div",Ee,[n(i(Z),{ref_key:"fileInputRef",ref:A,type:"file",accept:".csv,.xlsx,.xls,.json",disabled:N.value,onChange:G,class:"flex-1"},null,8,["disabled"]),n(i(v),{disabled:!C.value||N.value,onClick:ne},{default:d(()=>[n(i(R),{class:"w-4 h-4 mr-2"}),a[5]||(a[5]=c(" Importar ",-1))]),_:1},8,["disabled"])]),I.value.length>0?(r(),l("div",Ne,[n(i(T),null,{default:d(()=>[n(i(O),null,{default:d(()=>[n(i(q),{class:"text-lg"},{default:d(()=>[c(" Pré-visualização ("+f(I.value.length)+" registros) ",1)]),_:1})]),_:1}),n(i(P),null,{default:d(()=>[u("div",$e,[n(i(Q),null,{default:d(()=>[n(i(ee),null,{default:d(()=>[n(i(ae),null,{default:d(()=>[n(i(te),null,{default:d(()=>[...a[6]||(a[6]=[c("Unidade",-1)])]),_:1}),n(i(te),null,{default:d(()=>[...a[7]||(a[7]=[c("Tipo Documento",-1)])]),_:1}),n(i(te),null,{default:d(()=>[...a[8]||(a[8]=[c("Nome Metadado",-1)])]),_:1}),n(i(te),null,{default:d(()=>[...a[9]||(a[9]=[c("Tipo",-1)])]),_:1})]),_:1})]),_:1}),n(i(oe),null,{default:d(()=>[(r(!0),l(g,null,x(I.value.slice(0,10),(e,a)=>(r(),y(i(ae),{key:a},{default:d(()=>[n(i(se),null,{default:d(()=>[c(f(e.unidade),1)]),_:2},1024),n(i(se),null,{default:d(()=>[Array.isArray(e.tipoDocumento)?(r(),l("span",Pe,f(e.tipoDocumento.join(", ")),1)):(r(),l("span",Te,f(e.tipoDocumento),1))]),_:2},1024),n(i(se),null,{default:d(()=>[c(f(e.nomeMetadado),1)]),_:2},1024),n(i(se),null,{default:d(()=>[c(f(e.tipoMetadados),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),I.value.length>10?(r(),l("p",Oe," Mostrando 10 de "+f(I.value.length)+" registros ",1)):p("",!0)]),_:1})]),_:1})])):p("",!0),E.value?(r(),l("div",qe,[E.value.errors.length>0?(r(),y(i(B),{key:0,variant:"destructive"},{default:d(()=>[n(i(m),{class:"w-4 h-4"}),n(i(_),null,{default:d(()=>[c(f(E.value.errors.length)+" "+f(1===E.value.errors.length?"erro encontrado":"erros encontrados"),1)]),_:1}),n(i(V),null,{default:d(()=>[u("ul",Be,[(r(!0),l(g,null,x(E.value.errors.slice(0,5),(e,a)=>(r(),l("li",{key:a},f(e),1))),128))]),E.value.errors.length>5?(r(),l("p",Ve," ... e mais "+f(E.value.errors.length-5)+" erros ",1)):p("",!0)]),_:1})]),_:1})):p("",!0),E.value.warnings.length>0?(r(),y(i(B),{key:1,variant:"warning"},{default:d(()=>[n(i(m),{class:"w-4 h-4"}),n(i(_),null,{default:d(()=>[c(f(E.value.warnings.length)+" "+f(1===E.value.warnings.length?"aviso":"avisos"),1)]),_:1}),n(i(V),null,{default:d(()=>[u("ul",Re,[(r(!0),l(g,null,x(E.value.warnings.slice(0,3),(e,a)=>(r(),l("li",{key:a},f(e),1))),128))]),E.value.warnings.length>3?(r(),l("p",Ue," ... e mais "+f(E.value.warnings.length-3)+" avisos ",1)):p("",!0)]),_:1})]),_:1})):p("",!0)])):p("",!0),n(i(X)),u("div",Le,[n(i(Y),{class:"w-4 h-4"}),a[10]||(a[10]=c(" Formatos suportados: CSV, Excel (.xlsx, .xls), JSON ",-1))])]),_:1})]),_:1}),n(i(z),{open:$.value,"onUpdate:open":a[1]||(a[1]=e=>$.value=e)},{default:d(()=>[n(i(U),{class:"sm:max-w-md"},{default:d(()=>[n(i(L),null,{default:d(()=>[n(i(F),{class:"flex items-center gap-2"},{default:d(()=>[n(i(w),{class:"w-5 h-5 text-primary"}),a[11]||(a[11]=c(" Arquivo de Backup Detectado ",-1))]),_:1}),n(i(H),null,{default:d(()=>[...a[12]||(a[12]=[c(" Este arquivo é um ",-1),u("strong",null,"backup completo",-1),c(" do sistema, não uma lista de metadados. ",-1)])]),_:1})]),_:1}),a[15]||(a[15]=u("div",{class:"py-4"},[u("p",{class:"text-sm text-muted-foreground"},[c(" Para importar este arquivo corretamente, utilize a aba "),u("strong",null,'"Backup Completo"'),c(" na seção de Importar/Exportar. ")])],-1)),n(i(J),{class:"flex-col sm:flex-row gap-2"},{default:d(()=>[n(i(v),{variant:"outline",onClick:a[0]||(a[0]=e=>$.value=!1)},{default:d(()=>[...a[13]||(a[13]=[c(" Cancelar ",-1)])]),_:1}),n(i(v),{onClick:K},{default:d(()=>[n(i(le),{class:"w-4 h-4 mr-2"}),a[14]||(a[14]=c(" Ir para Backup Completo ",-1))]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])],64))}};function Je(e){let a=e.toString();return["=","+","-","@","\t","\r","\n"].some(e=>a.startsWith(e))&&(a="'"+a),a=a.replace(/"/g,'""'),`"${a}"`}function ze(e){if(null==e)return"";const a=String(e);return["=","+","-","@","\t","\r","\n"].some(e=>a.startsWith(e))?"'"+a:a}const He={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Ge={class:"flex items-center gap-2 text-sm text-muted-foreground"},Ke={__name:"ExportCard",setup(e){const a=t();async function o(e){try{const t=a.metadados;if(0===t.length)return void h.error("Não há dados para exportar");switch(e){case"csv":!function(e){const a=e.map(e=>[e.unidade||"",e.metadadoDeProcesso?"Sim":"Não",e.classeProcessual||"Não informado",Array.isArray(e.tipoDocumento)?e.tipoDocumento.join(";"):e.tipoDocumento||"",e.nomeMetadado||"",e.objetivoMetadado||"",e.objetivoNaoInformado?"Sim":"Não",e.formatoMetadado||"",e.admiteMultiplos?"Sim":"Não",e.tipoMetadados||"",e.versaoInicialAtende||"",e.observacao||"",Array.isArray(e.tags)?e.tags.join(";"):"",e.imagens&&e.imagens.length>0?`${e.imagens.length} ${1===e.imagens.length?"imagem":"imagens"}`:"—"]);let t=["Unidade","Metadado de Processo","Classe Processual","Tipo de Documento","Nome do Metadado","Objetivo","Objetivo Não Informado","Formato","Admite Múltiplos","Tipo de Metadados","Versão Inicial Atende","Observação","Tags","Imagens"].map(Je).join(",")+"\n";a.forEach(e=>{t+=e.map(Je).join(",")+"\n"});const o=new Blob([t],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a");s.href=URL.createObjectURL(o),s.download=`metadados_${(new Date).toISOString().split("T")[0]}.csv`,s.click()}(t),h.success(`${t.length} registros exportados para CSV`);break;case"excel":!function(e){const a=e.map(e=>({Unidade:ze(e.unidade),"Metadado de Processo":e.metadadoDeProcesso?"Sim":"Não","Classe Processual":ze(e.classeProcessual||"Não informado"),"Tipo de Documento":ze(Array.isArray(e.tipoDocumento)?e.tipoDocumento.join(";"):e.tipoDocumento),"Nome do Metadado":ze(e.nomeMetadado),Objetivo:ze(e.objetivoMetadado),"Objetivo Não Informado":e.objetivoNaoInformado?"Sim":"Não",Formato:ze(e.formatoMetadado),"Admite Múltiplos":e.admiteMultiplos?"Sim":"Não","Tipo de Metadados":ze(e.tipoMetadados),"Versão Inicial Atende":ze(e.versaoInicialAtende),"Observação":ze(e.observacao),Tags:ze(Array.isArray(e.tags)?e.tags.join(";"):""),Imagens:e.imagens&&e.imagens.length>0?`${e.imagens.length} ${1===e.imagens.length?"imagem":"imagens"}`:"—"})),t=A.json_to_sheet(a);t["!cols"]=[{wch:15},{wch:20},{wch:35},{wch:30},{wch:30},{wch:40},{wch:18},{wch:20},{wch:18},{wch:18},{wch:22},{wch:40},{wch:25},{wch:15}];const o=[];e.forEach(e=>{(Array.isArray(e.tipoDocumento)?e.tipoDocumento:e.tipoDocumento?[e.tipoDocumento]:["Não especificado"]).forEach(a=>{o.push({"Tipo de Documento":ze(a),"Nome do Metadado":ze(e.nomeMetadado),Unidade:ze(e.unidade),Objetivo:ze(e.objetivoMetadado),"Objetivo Não Informado":e.objetivoNaoInformado?"Sim":"Não",Formato:ze(e.formatoMetadado),"Admite Múltiplos":e.admiteMultiplos?"Sim":"Não","Tipo de Metadados":ze(e.tipoMetadados),"Metadado de Processo":e.metadadoDeProcesso?"Sim":"Não","Versão Inicial Atende":ze(e.versaoInicialAtende),"Observação":ze(e.observacao),"Classe Processual":ze(e.classeProcessual||"Não informado"),Tags:ze(Array.isArray(e.tags)?e.tags.join(";"):""),Imagens:e.imagens&&e.imagens.length>0?`${e.imagens.length} ${1===e.imagens.length?"imagem":"imagens"}`:"—"})})}),o.sort((e,a)=>{const t=e["Tipo de Documento"].localeCompare(a["Tipo de Documento"]);return 0!==t?t:e["Nome do Metadado"].localeCompare(a["Nome do Metadado"])});const s=A.json_to_sheet(o);s["!cols"]=[{wch:35},{wch:30},{wch:15},{wch:40},{wch:18},{wch:20},{wch:18},{wch:18},{wch:20},{wch:22},{wch:40},{wch:35},{wch:25},{wch:15}];const l=A.book_new();A.book_append_sheet(l,t,"Metadados"),A.book_append_sheet(l,s,"Por Tipo de Documento"),C(l,`metadados_${(new Date).toISOString().split("T")[0]}.xlsx`)}(t),h.success(`${t.length} registros exportados para Excel`);break;case"json":!function(e){const a=JSON.stringify(e,null,2),t=new Blob([a],{type:"application/json"}),o=document.createElement("a");o.href=URL.createObjectURL(t),o.download=`metadados_${(new Date).toISOString().split("T")[0]}.json`,o.click()}(t),h.success(`${t.length} registros exportados para JSON`)}}catch(t){h.error("Erro ao exportar: "+t.message)}}return(e,t)=>(r(),y(i(T),null,{default:d(()=>[n(i(O),null,{default:d(()=>[n(i(q),{class:"flex items-center gap-2"},{default:d(()=>[n(i(de),{class:"w-5 h-5"}),t[3]||(t[3]=c(" Exportar Dados ",-1))]),_:1})]),_:1}),n(i(P),{class:"space-y-6"},{default:d(()=>[n(i(B),null,{default:d(()=>[n(i(Y),{class:"w-4 h-4"}),n(i(_),null,{default:d(()=>[...t[4]||(t[4]=[c("Informação",-1)])]),_:1}),n(i(V),null,{default:d(()=>[c(" Exporte todos os "+f(i(a).totalMetadados)+" metadados cadastrados no formato desejado. ",1)]),_:1})]),_:1}),u("div",He,[n(i(T),{class:"cursor-pointer transition-all hover:bg-accent",onClick:t[0]||(t[0]=e=>o("csv"))},{default:d(()=>[n(i(P),{class:"flex flex-col items-center justify-center py-8 space-y-3"},{default:d(()=>[n(i(ie),{class:"w-12 h-12 text-muted-foreground"}),t[5]||(t[5]=u("div",{class:"text-lg font-semibold"},"CSV",-1)),t[6]||(t[6]=u("div",{class:"text-sm text-muted-foreground text-center"},"Valores Separados por Vírgula",-1))]),_:1})]),_:1}),n(i(T),{class:"cursor-pointer transition-all hover:bg-accent",onClick:t[1]||(t[1]=e=>o("excel"))},{default:d(()=>[n(i(P),{class:"flex flex-col items-center justify-center py-8 space-y-3"},{default:d(()=>[n(i(ie),{class:"w-12 h-12 text-muted-foreground"}),t[7]||(t[7]=u("div",{class:"text-lg font-semibold"},"Excel",-1)),t[8]||(t[8]=u("div",{class:"text-sm text-muted-foreground text-center"},"Planilha XLSX",-1))]),_:1})]),_:1}),n(i(T),{class:"cursor-pointer transition-all hover:bg-accent",onClick:t[2]||(t[2]=e=>o("json"))},{default:d(()=>[n(i(P),{class:"flex flex-col items-center justify-center py-8 space-y-3"},{default:d(()=>[n(i(ne),{class:"w-12 h-12 text-muted-foreground"}),t[9]||(t[9]=u("div",{class:"text-lg font-semibold"},"JSON",-1)),t[10]||(t[10]=u("div",{class:"text-sm text-muted-foreground text-center"},"JavaScript Object Notation",-1))]),_:1})]),_:1})]),n(i(X)),u("div",Ge,[n(i(Y),{class:"w-4 h-4"}),t[11]||(t[11]=c(" O arquivo será baixado automaticamente após a exportação ",-1))])]),_:1})]),_:1}))}},We={class:"space-y-6"},Xe={class:"flex items-center justify-between"},Ye={__name:"ImportExport",setup(e){const a=s("importar");function t(e){a.value=e}return(e,o)=>(r(),l("div",We,[u("div",Xe,[o[2]||(o[2]=u("h1",{class:"text-3xl font-bold"},"Importar/Exportar",-1)),n(i(b),{variant:"secondary",class:"flex items-center gap-2"},{default:d(()=>[n(i(Y),{class:"w-4 h-4"}),o[1]||(o[1]=c(" Gerencie seus dados em diferentes formatos ",-1))]),_:1})]),n(i($),{modelValue:a.value,"onUpdate:modelValue":o[0]||(o[0]=e=>a.value=e),class:"w-full"},{default:d(()=>[n(i(I),{class:"grid w-full grid-cols-3"},{default:d(()=>[n(i(E),{value:"importar",class:"flex items-center gap-2"},{default:d(()=>[n(i(R),{class:"w-4 h-4"}),o[3]||(o[3]=c(" Importar Metadados ",-1))]),_:1}),n(i(E),{value:"exportar",class:"flex items-center gap-2"},{default:d(()=>[n(i(W),{class:"w-4 h-4"}),o[4]||(o[4]=c(" Exportar Metadados ",-1))]),_:1}),n(i(E),{value:"backup",class:"flex items-center gap-2"},{default:d(()=>[n(i(w),{class:"w-4 h-4"}),o[5]||(o[5]=c(" Backup Completo ",-1))]),_:1})]),_:1}),n(i(N),{value:"importar",class:"space-y-4 mt-6"},{default:d(()=>[o[6]||(o[6]=u("div",null,[u("h2",{class:"text-xl font-semibold mb-1"},"Importar Metadados"),u("p",{class:"text-sm text-muted-foreground"}," Importe registros de metadados de arquivos CSV, Excel ou JSON ")],-1)),n(Fe,{onSwitchTab:t})]),_:1}),n(i(N),{value:"exportar",class:"space-y-4 mt-6"},{default:d(()=>[o[7]||(o[7]=u("div",null,[u("h2",{class:"text-xl font-semibold mb-1"},"Exportar Apenas Metadados"),u("p",{class:"text-sm text-muted-foreground"}," Exporte somente os registros de metadados em diferentes formatos ")],-1)),n(Ke)]),_:1}),n(i(N),{value:"backup",class:"space-y-4 mt-6"},{default:d(()=>[o[8]||(o[8]=u("div",null,[u("h2",{class:"text-xl font-semibold mb-1"},"Backup Completo do Sistema"),u("p",{class:"text-sm text-muted-foreground"}," Exporte e importe todos os dados do sistema incluindo configurações e histórico ")],-1)),n(Ie)]),_:1})]),_:1},8,["modelValue"])]))}};export{Ye as default};
