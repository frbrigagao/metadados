import{G as e,aI as t,b as n,aJ as o,r,w as u,av as a,aK as s,ap as i,n as c,a as l,ax as d,aL as f,d as p,H as v,ak as m,au as y,e as g,f as h,g as b,J as w,l as E,P as A}from"./index-Fg9cHY2_.js";function S(){let e=document.activeElement;if(null==e)return null;for(;null!=e&&null!=e.shadowRoot&&null!=e.shadowRoot.activeElement;)e=e.shadowRoot.activeElement;return e}const[F]=e("ConfigProvider");function L(e){if(null===e||"object"!=typeof e)return!1;const t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&(!(Symbol.iterator in e)&&(!(Symbol.toStringTag in e)||"[object Module]"===Object.prototype.toString.call(e)))}function N(e,t,n=".",o){if(!L(t))return N(e,{},n,o);const r=Object.assign({},t);for(const u in e){if("__proto__"===u||"constructor"===u)continue;const t=e[u];null!=t&&(o&&o(r,u,t,n)||(Array.isArray(t)&&Array.isArray(r[u])?r[u]=[...t,...r[u]]:L(t)&&L(r[u])?r[u]=N(t,r[u],(n?`${n}.`:"")+u.toString(),o):r[u]=t))}return r}const T=(...e)=>e.reduce((e,t)=>N(e,t,"",M),{});var M;const O=t(()=>{const e=r(new Map),t=r(),o=n(()=>{for(const t of e.value.values())if(t)return!0;return!1}),l=F({scrollBody:r(!0)});let d=null;return u(o,(e,n)=>{if(!a)return;if(!e)return void(n&&(document.body.style.paddingRight="",document.body.style.marginRight="",document.body.style.pointerEvents="",document.documentElement.style.removeProperty("--scrollbar-width"),document.body.style.overflow=t.value??"",s&&d?.(),t.value=void 0));void 0===t.value&&(t.value=document.body.style.overflow);const o=window.innerWidth-document.documentElement.clientWidth,r={padding:o,margin:0},u=l.scrollBody?.value?"object"==typeof l.scrollBody.value?T({padding:!0===l.scrollBody.value.padding?o:l.scrollBody.value.padding,margin:!0===l.scrollBody.value.margin?o:l.scrollBody.value.margin},r):r:{padding:0,margin:0};o>0&&(document.body.style.paddingRight="number"==typeof u.padding?`${u.padding}px`:String(u.padding),document.body.style.marginRight="number"==typeof u.margin?`${u.margin}px`:String(u.margin),document.documentElement.style.setProperty("--scrollbar-width",`${o}px`),document.body.style.overflow="hidden"),s&&(d=i(document,"touchmove",e=>function(e){const t=e||window.event,n=t.target;if(n instanceof Element&&P(n))return!1;if(t.touches.length>1)return!0;t.preventDefault&&t.cancelable&&t.preventDefault();return!1}(e),{passive:!1})),c(()=>{document.body.style.pointerEvents="none",document.body.style.overflow="hidden"})},{immediate:!0,flush:"sync"}),e});function B(e){const t=Math.random().toString(36).substring(2,7),r=O();r.value.set(t,e??!1);const u=n({get:()=>r.value.get(t)??!1,set:e=>r.value.set(t,e)});return o(()=>{r.value.delete(t)}),u}function P(e){const t=window.getComputedStyle(e);if("scroll"===t.overflowX||"scroll"===t.overflowY||"auto"===t.overflowX&&e.clientWidth<e.scrollWidth||"auto"===t.overflowY&&e.clientHeight<e.scrollHeight)return!0;{const t=e.parentNode;return t instanceof Element&&"BODY"!==t.tagName&&P(t)}}var R=new WeakMap,W=new WeakMap,_={},k=0,x=function(e){return e&&(e.host||x(e.parentNode))},C=function(e,t,n,o){var r=function(e,t){return t.map(function(t){if(e.contains(t))return t;var n=x(t);return n&&e.contains(n)?n:null}).filter(function(e){return Boolean(e)})}(t,Array.isArray(e)?e:[e]);_[n]||(_[n]=new WeakMap);var u=_[n],a=[],s=new Set,i=new Set(r),c=function(e){e&&!s.has(e)&&(s.add(e),c(e.parentNode))};r.forEach(c);var l=function(e){e&&!i.has(e)&&Array.prototype.forEach.call(e.children,function(e){if(s.has(e))l(e);else try{var t=e.getAttribute(o),r=null!==t&&"false"!==t,i=(R.get(e)||0)+1,c=(u.get(e)||0)+1;R.set(e,i),u.set(e,c),a.push(e),1===i&&r&&W.set(e,!0),1===c&&e.setAttribute(n,"true"),r||e.setAttribute(o,"true")}catch(d){}})};return l(t),s.clear(),k++,function(){a.forEach(function(e){var t=R.get(e)-1,r=u.get(e)-1;R.set(e,t),u.set(e,r),t||(W.has(e)||e.removeAttribute(o),W.delete(e)),r||e.removeAttribute(n)}),--k||(R=new WeakMap,R=new WeakMap,W=new WeakMap,_={})}},j=function(e,t,n){void 0===n&&(n="data-aria-hidden");var o=Array.from(Array.isArray(e)?e:[e]),r=function(e){return"undefined"==typeof document?null:(Array.isArray(e)?e[0]:e).ownerDocument.body}(e);return r?(o.push.apply(o,Array.from(r.querySelectorAll("[aria-live], script"))),C(o,r,n,"aria-hidden")):function(){return null}};function I(e){let t;u(()=>d(e),e=>{e?t=j(e):t&&t()}),l(()=>{t&&t()})}const K=f(()=>r([]));function D(e,t){const n=[...e],o=n.indexOf(t);return-1!==o&&n.splice(o,1),n}const q="focusScope.autoFocusOnMount",H="focusScope.autoFocusOnUnmount",$={bubbles:!1,cancelable:!0};function Y(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:e=>{const t="INPUT"===e.tagName&&"hidden"===e.type;return e.disabled||e.hidden||t?NodeFilter.FILTER_SKIP:e.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function J(e,t){for(const n of e)if(!U(n,{upTo:t}))return n}function U(e,{upTo:t}){if("hidden"===getComputedStyle(e).visibility)return!0;for(;e;){if(void 0!==t&&e===t)return!1;if("none"===getComputedStyle(e).display)return!0;e=e.parentElement}return!1}function X(e,{select:t=!1}={}){if(e&&e.focus){const n=S();e.focus({preventScroll:!0}),e!==n&&function(e){return e instanceof HTMLInputElement&&"select"in e}(e)&&t&&e.select()}}var G=p({__name:"FocusScope",props:{loop:{type:Boolean,required:!1,default:!1},trapped:{type:Boolean,required:!1,default:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["mountAutoFocus","unmountAutoFocus"],setup(e,{emit:t}){const n=e,o=t,{currentRef:u,currentElement:s}=v(),i=r(null),l=function(){const e=K();return{add(t){const n=e.value[0];t!==n&&n?.pause(),e.value=D(e.value,t),e.value.unshift(t)},remove(t){e.value=D(e.value,t),e.value[0]?.resume()}}}(),d=m({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}});function f(e){if(!n.loop&&!n.trapped)return;if(d.paused)return;const t="Tab"===e.key&&!e.altKey&&!e.ctrlKey&&!e.metaKey,o=S();if(t&&o){const t=e.currentTarget,[r,u]=function(e){const t=Y(e);return[J(t,e),J(t.reverse(),e)]}(t);r&&u?e.shiftKey||o!==u?e.shiftKey&&o===r&&(e.preventDefault(),n.loop&&X(u,{select:!0})):(e.preventDefault(),n.loop&&X(r,{select:!0})):o===t&&e.preventDefault()}}return y(e=>{if(!a)return;const t=s.value;if(!n.trapped)return;function o(e){if(d.paused||!t)return;const n=e.target;t.contains(n)?i.value=n:X(i.value,{select:!0})}function r(e){if(d.paused||!t)return;const n=e.relatedTarget;null!==n&&(t.contains(n)||X(i.value,{select:!0}))}document.addEventListener("focusin",o),document.addEventListener("focusout",r);const u=new MutationObserver(function(e){t.contains(i.value)||X(t)});t&&u.observe(t,{childList:!0,subtree:!0}),e(()=>{document.removeEventListener("focusin",o),document.removeEventListener("focusout",r),u.disconnect()})}),y(async e=>{const t=s.value;if(await c(),!t)return;l.add(d);const n=S();if(!t.contains(n)){const e=new CustomEvent(q,$);t.addEventListener(q,e=>o("mountAutoFocus",e)),t.dispatchEvent(e),e.defaultPrevented||(!function(e,{select:t=!1}={}){const n=S();for(const o of e)if(X(o,{select:t}),S()!==n)return!0}((r=Y(t),r.filter(e=>"A"!==e.tagName)),{select:!0}),S()===n&&X(t))}var r;e(()=>{t.removeEventListener(q,e=>o("mountAutoFocus",e));const e=new CustomEvent(H,$),r=e=>{o("unmountAutoFocus",e)};t.addEventListener(H,r),t.dispatchEvent(e),setTimeout(()=>{e.defaultPrevented||X(n??document.body,{select:!0}),t.removeEventListener(H,r),l.remove(d)},0)})}),(e,t)=>(h(),g(E(A),{ref_key:"currentRef",ref:u,tabindex:"-1","as-child":e.asChild,as:e.as,onKeydown:f},{default:b(()=>[w(e.$slots,"default")]),_:3},8,["as-child","as"]))}});function z(e){return e?"open":"closed"}function Q(e){const t=S();for(const n of e){if(n===t)return;if(n.focus(),S()!==t)return}}export{G as F,I as a,z as b,Q as f,S as g,F as i,B as u};
